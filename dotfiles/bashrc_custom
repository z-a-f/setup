# echo ".BASHRC_CUSTOM"
# .bashrc_custom file
# By Zafar M. Takhirov (cc.rafaz@zafar.cc)
#
# This file can have anything that is not included in .bashrc
# Use this file for customization rather than global/environment setup

## Bug fix for CHROOT, where the environment is not read
pathmunge /usr/local/games
pathmunge /usr/games
pathmunge /bin
pathmunge /sbin
pathmunge /usr/bin
pathmunge /usr/sbin
pathmunge /usr/local/bin
pathmunge /usr/local/sbin
export LC_ALL=en_US.UTF-8

########################################################################################################
## Libraries
# test -e /usr/local/cuda && export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64
########################################################################################################

# Options:
shopt -s autocd                 # Enable auto-cd
shopt -s globstar		# Enable stars in the path

# make sure the C-h is working properly
[[ $- == *i* ]] && stty erase 

# Custom BIN paths:
## This will be included as a very last resort, and will hold only executables with the least priority: 
pathmunge ${HOME}/bin
test -e /usr/local/cuda && pathmunge /usr/local/cuda/bin

# Custom bin paths have to be BEFORE $PATH.
# We want our scripts to have priority, right?

# Change the prompt:
if [ -f "${HOME}/.bash_prompt" ]; then
    source ${HOME}/.bash_prompt
else
    export PS1="\[${Color_Off}${BICyan}\u${White}@${BIGreen}\h${White}:${BIYellow}\W${Color_Off}\]\n\$> "
    source /etc/profile.d/vte.sh
fi

if [ -f "${HOME}/.bash_aliases" ]; then
    source ${HOME}/.bash_aliases
fi

# Setup better colors:
export CLICOLOR=1
export LSCOLORS=GxFxCxDxCxegedabagaced
export LS_COLORS="di=01;33:ln=04;35:or=5;37;41:so=33:ex=00;32"

# Also change the terminal colors as well
export TERM=xterm-256color

# User Environment Variables:

# Fixes and Bugs:
# LANG=en_US.UTF8
export LANG=en_US.UTF-8
export LANGUAGE=en_US.UTF-8
export LC_ALL=en_US.UTF-8

# Export other stuff that you might need:

## If the virtualenvwrapper is installed, make sure it is sourced
if [ -f "`which virtualenvwrapper.sh`" ]; then
    export WORKON_HOME=$HOME/.virtualenvs
    export PROJECT_HOME=$HOME/DevProjects
    export VIRTUALENVWRAPPER_SCRIPT=`which virtualenvwrapper.sh`
    source `which virtualenvwrapper_lazy.sh`
fi

if [ -f ~/.secretrc ]; then
    # [[ $- == *i* ]] && echo -e "*INFO*, Loading secret configs"
    source ~/.secretrc ## Place any private things, like API tokens here
fi

# PyENV
if ! ischroot ; then
    export PYENV_ROOT="${HOME}/.pyenv"
    pathmunge ${PYENV_ROOT}/bin
    eval "$(pyenv init -)"
fi

## In case you are using Bash on a specific machine edit it below
if [ -f ~/.bashrc_work_machine ]; then
    source ~/.bashrc_work_machine
fi

### Final step, cleanup any duplicates in the environment variables (preserve order)
alias path_cleanup="python -c \"import sys; from collections import OrderedDict; print ':'.join(list(OrderedDict.fromkeys(sys.argv[1].split(':'))))\""

### Final Final step, export all!
export PATH
export MANPATH

test `which direnv` && eval "$(direnv hook bash)"
